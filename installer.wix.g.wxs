<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
<!--
<auto-generated>
    This code was generated by WixSharp.
    Changes to this file will be lost if the code is regenerated.
    To suppress generation of this file remove `set ide=true` from the PostBuildEvent of the VS project
</auto-generated>
-->
  <Package Compressed="yes" ProductCode="89177a6f-4cd3-4569-9788-51961810dc16" Name="BIMAL" Language="1049" Version="7.1.1.8" UpgradeCode="89177a6f-4cd3-4569-9788-5196a800cc0d" Manufacturer="BIMAL" Scope="perUser" InstallerVersion="200">
    <SummaryInformation Codepage="Windows-1252" />

    <Directory Id="INSTALLDIR" Name="ABSOLUTEPATH">
      <Directory Id="BIMAL" Name="BIMAL">
        <Directory Id="RevitAddin" Name="RevitAddin">
          <Directory Id="Files" Name="Files">
            <Directory Id="BIMAL.addin" Name="BIMAL.addin">

              <Component Id="Component.BIMAL.addin.EmptyDirectory" Guid="89177a6f-4cd3-4569-9788-519625bc4dba" KeyPath="yes">
                <CreateFolder />
                <RemoveFolder Id="BIMAL.addin" On="uninstall" />
              </Component>

            </Directory>

            <Component Id="Files" Guid="89177a6f-4cd3-4569-9788-5196c2f42fa8" KeyPath="yes">
              <CreateFolder />
              <RemoveFolder Id="Files" On="uninstall" />
            </Component>

          </Directory>

          <Component Id="RevitAddin" Guid="89177a6f-4cd3-4569-9788-5196ebee0041" KeyPath="yes">
            <CreateFolder />
            <RemoveFolder Id="RevitAddin" On="uninstall" />
          </Component>

        </Directory>

        <Component Id="BIMAL" Guid="89177a6f-4cd3-4569-9788-5196b28aae8b" KeyPath="yes">
          <CreateFolder />
          <RemoveFolder Id="BIMAL" On="uninstall" />
        </Component>

      </Directory>

      <Component Id="INSTALLDIR" Guid="89177a6f-4cd3-4569-9788-5196531d31e5" KeyPath="yes">
        <CreateFolder />
        <RemoveFolder Id="INSTALLDIR" On="uninstall" />
      </Component>

    </Directory>

    <UI />

    <WixUI Id="WixUI_Minimal" xmlns="http://wixtoolset.org/schemas/v4/wxs/ui" />

    <UI>
      <EmbeddedUI Id="WixSharp_EmbeddedUI_Asm" SourceFile="WixSharp.UI.CA.dll" />
    </UI>

    <CustomAction Id="WixSharp_InitRuntime_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_InitRuntime_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_CancelRequestHandler_Props" Property="CancelRequestHandler" Value="UpgradeCode=[UpgradeCode];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="CancelRequestHandler" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="CancelRequestHandler" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="WixSharp_Load_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_Load_Action" Return="check" Execute="immediate" />
    <CustomAction Id="WixSharp_BeforeInstall_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_BeforeInstall_Action" Return="check" Execute="immediate" />
    <CustomAction Id="Set_WixSharp_AfterInstall_Action_Props" Property="WixSharp_AfterInstall_Action" Value="WixSharp_AfterInstall_Handlers=[WixSharp_AfterInstall_Handlers];WIXSHARP_RUNTIME_DATA=[WIXSHARP_RUNTIME_DATA];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductName=[ProductName];FOUNDPREVIOUSVERSION=[FOUNDPREVIOUSVERSION];UpgradeCode=[UpgradeCode];ManagedProjectElevatedEvents=[ManagedProjectElevatedEvents];MsiLogFileLocation=[MsiLogFileLocation];INSTALLDIR=[INSTALLDIR];UILevel=[UILevel];ProductCode=[ProductCode];ADDLOCAL=[ADDLOCAL];ADDFEATURES=[ADDFEATURES]" />
    <CustomAction Id="WixSharp_AfterInstall_Action" BinaryRef="WixSharp_InitRuntime_Action_File" DllEntry="WixSharp_AfterInstall_Action" Return="check" Impersonate="no" Execute="deferred" />
    <CustomAction Id="Set_DirAbsolutePath" Property="INSTALLDIR" Value="C:\Users\AppData\Roaming\Autodesk\RevitAddins\2024" />

    <Binary Id="WixSharp_InitRuntime_Action_File" SourceFile="WixSharp.CA.dll" />
   
    <Binary Id="WixSharp_LicenceFile" SourceFile="BIMAL.licence.rtf" />
    <Binary Id="WixSharpUI_Bmp_Dialog" SourceFile="BIMAL.dialog_bmp.png" />
    <Binary Id="WixSharpUI_Bmp_Banner" SourceFile="BIMAL.dialog_banner.png" />

    <Property Id="WixSharp_UI_INSTALLDIR" Value="INSTALLDIR" />
    <Property Id="UAC_WARNING" Value="Please wait for UAC prompt to appear.&#xD;&#xA;&#xD;&#xA;If it appears minimized then activate it from the taskbar." />
    <Property Id="WixSharp_InstallDialogs" Value="WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.WelcomeDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.LicenceDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ExitDialog" />
    <Property Id="WixSharp_ModifyDialogs" Value="WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.MaintenanceTypeDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.FeaturesDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ProgressDialog&#xA;WixSharp.UI, Version=2.4.0.0, Culture=neutral, PublicKeyToken=3775edd25acc43c2|WixSharp.UI.Forms.ExitDialog" />
    <Property Id="WixSharp_UIInitialized_Handlers" Value="installer.wix, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null|WixInstaller.Program|UI_Initialized" />
    <Property Id="WixSharp_Load_Handlers" Value="installer.wix, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null|WixInstaller.Program|MSI_Load" />
    <Property Id="WixSharp_BeforeInstall_Handlers" Value="installer.wix, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null|WixInstaller.Program|MSI_BeforeInstall" />
    <Property Id="WixSharp_AfterInstall_Handlers" Value="installer.wix, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null|WixInstaller.Program|MSI_AfterInstall" />
    <Property Id="INSTALLDIR_ABSOLUTEPATH" Value="C:\Users\AppData\Roaming\Autodesk\RevitAddins\2024" />

    <Feature Id="Complete" Title="Complete" Level="1" AllowAbsent="yes">
      <ComponentRef Id="Component.BIMAL.addin.EmptyDirectory" />
      <ComponentRef Id="Files" />
      <ComponentRef Id="RevitAddin" />
      <ComponentRef Id="BIMAL" />
      <ComponentRef Id="INSTALLDIR" />
    </Feature>

    <InstallExecuteSequence>
      <Custom Condition=" (1) " Action="WixSharp_InitRuntime_Action" Before="AppSearch" />
      <Custom Action="Set_CancelRequestHandler_Props" Before="InstallFinalize" />
      <Custom Condition=" (1) " Action="CancelRequestHandler" After="Set_CancelRequestHandler_Props" />
      <Custom Condition="1" Action="WixSharp_Load_Action" Before="AppSearch" />
      <Custom Condition="1" Action="WixSharp_BeforeInstall_Action" Before="InstallFiles" />
      <Custom Action="Set_WixSharp_AfterInstall_Action_Props" After="InstallFiles" />
      <Custom Condition="1" Action="WixSharp_AfterInstall_Action" After="Set_WixSharp_AfterInstall_Action_Props" />
      <Custom Condition="(NOT Installed) AND (UILevel &lt; 5) AND (INSTALLDIR = ABSOLUTEPATH)" Action="Set_DirAbsolutePath" Before="AppSearch" />
    </InstallExecuteSequence>

    <InstallUISequence>
      <Custom Condition="(NOT Installed) AND (UILevel = 5) AND (INSTALLDIR = ABSOLUTEPATH)" Action="Set_DirAbsolutePath" Before="AppSearch" />
    </InstallUISequence>
  </Package>
</Wix>

